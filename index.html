<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Urudle ðŸ§‰</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      text-align: center; 
      background-color: #f4f4f4; 
      margin: 0; 
      padding: 0;
    }
    .logo { 
      margin-top: 20px; 
      max-width: 300px; 
      width: 100%; 
      height: auto; 
    }
    .grid-container { 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      margin-top: 20px; 
    }
    .grid { 
      display: grid; 
      grid-template-columns: repeat(5, 50px); 
      gap: 5px; 
    }
    .row { 
      display: flex; 
    }
    .cell { 
      width: 50px; 
      height: 50px; 
      border: 2px solid #ccc; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      font-size: 24px; 
      font-weight: bold; 
      text-transform: uppercase; 
      background-color: white; 
    }
    .correct { background-color: green; color: white; }
    .present { background-color: orange; color: white; }
    .absent { background-color: gray; color: white; }
    /* Se aumenta el nÃºmero de columnas a 11 para incluir la Ã‘ */
    .keyboard { 
      display: grid; 
      grid-template-columns: repeat(11, 30px); 
      gap: 5px; 
      justify-content: center; 
      margin-top: 20px; 
    }
    .key { 
      width: 30px; 
      height: 30px; 
      border: 2px solid #ccc; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      font-size: 16px; 
      font-weight: bold; 
      text-transform: uppercase; 
      background-color: lightgray; 
      cursor: pointer; 
    }
    .key.correct { background-color: green; color: white; }
    .key.present { background-color: orange; color: white; }
    .key.absent { background-color: red; color: white; }
    .popup { 
      display: none; 
      position: fixed; 
      top: 50%; 
      left: 50%; 
      transform: translate(-50%, -50%); 
      background: white; 
      padding: 20px; 
      border: 2px solid black; 
      box-shadow: 2px 2px 10px rgba(0,0,0,0.3); 
    }
    /* Input oculto para que en mobile se active el teclado */
    #hiddenInput { 
      position: absolute; 
      opacity: 0; 
      height: 0; 
      width: 0; 
    }
  </style>
</head>
<body>
  <!-- Logo que reemplaza el tÃ­tulo -->
  <img src="logo.png" alt="Urudle" class="logo" />
  <p id="countdown"></p>
  <div class="grid-container" id="grid"></div>
  <p id="message"></p>
  <div class="keyboard" id="keyboard"></div>
  
  <!-- Input oculto para activar el teclado en mobile -->
  <input type="text" id="hiddenInput" autofocus />

  <div id="popup" class="popup">
    <h2>Â¡Felicidades!</h2>
    <p id="definition"></p>
    <h3>EstadÃ­sticas</h3>
    <p>Total jugados: <span id="totalGames">0</span></p>
    <p>Racha actual: <span id="currentStreak">0</span></p>
    <p>Racha mÃ¡s larga: <span id="bestStreak">0</span></p>
    <button onclick="closePopup()">Cerrar</button>
  </div>

  <script>
    // Para que en mobile el teclado se mantenga abierto
    const hiddenInput = document.getElementById("hiddenInput");
    window.addEventListener("load", () => { hiddenInput.focus(); });
    hiddenInput.addEventListener("blur", () => { setTimeout(() => hiddenInput.focus(), 0); });

    const wordList = ["manya", "burro", "pucho", "yuyos", "cheto", "Ã±oqui", "quemo", "bardo", "pique", "gamba", "boton", "birra", "facha", "asado", "fiero", "trapo", "pinta", "fiaca", "chori"];
    const definitions = {
      "MANYA": "Hinchas del Club AtlÃ©tico PeÃ±arol.",
      "BURRO": "Animal de carga, tambiÃ©n se usa como insulto.",
      "PUCHO": "Resto del cigarro o algo en pequeÃ±a cantidad.",
      "YUYOS": "Hierbas silvestres, tambiÃ©n usada en infusiones.",
      "CHETO": "Persona con dinero.",
      "Ã‘OQUI": "Persona que tiene un puesto de trabajo pero no hace nada.",
      "QUEMO": "Persona que hace pasar vergÃ¼enza a los demÃ¡s.",
      "BARDO": "Se utiliza para referirse a un lÃ­o, descontrol, quilombo o despelote.",
      "PIQUE": "Dar o recibir una especie de consejo.",
      "GAMBA": "Pierna, se utiliza tambiÃ©n para pedir que no te dejen solo/tirado.",
      "BOTON": "Se utiliza para referirse a un policÃ­a o a un delator.",
      "BIRRA": "Forma de llamar a la cerveza.",
      "FACHA": "Una persona que se ve o se viste bien.",
      "ASADO": "Comida tÃ­pica de Uruguay, carne cocinada a las brasas.",
      "FIERO": "Alguien o algo feo, muy feo.",
      "TRAPO": "Bandera que suele utilizarse para alentar a un equipo de fÃºtbol.",
      "PINTA": "Se utiliza para indicar una medida de cerveza y para decir que una persona estÃ¡ elegante.",
      "FIACA": "Forma de decir que tenÃ©s pereza o paja.",
      "CHORI": "Disminutivo de chorizo, comida tÃ­pica de Uruguay."
    };

    const todayIndex = new Date().getDate() % wordList.length;
    const word = wordList[todayIndex].toUpperCase();
    let attempts = Array(6).fill(null).map(() => Array(5).fill({ char: "", status: "" }));
    let usedLetters = {};
    let currentAttempt = 0;
    let currentLetter = 0;
    const maxAttempts = 6;

    function createGrid() {
      const gridContainer = document.getElementById("grid");
      gridContainer.innerHTML = "";
      attempts.forEach((row) => {
        const rowDiv = document.createElement("div");
        rowDiv.className = "row";
        row.forEach((cell) => {
          let cellDiv = document.createElement("div");
          cellDiv.className = "cell " + cell.status;
          cellDiv.textContent = cell.char;
          rowDiv.appendChild(cellDiv);
        });
        gridContainer.appendChild(rowDiv);
      });
    }

    function createKeyboard() {
      const keyboardContainer = document.getElementById("keyboard");
      keyboardContainer.innerHTML = "";
      // Alfabeto espaÃ±ol con Ã‘
      const letters = "ABCDEFGHIJKLMNÃ‘OPQRSTUVWXYZ".split("");
      letters.forEach(letter => {
        let key = document.createElement("div");
        key.className = "key";
        key.textContent = letter;
        if (usedLetters[letter]) {
          key.classList.add(usedLetters[letter]);
        }
        keyboardContainer.appendChild(key);
      });
    }

    hiddenInput.addEventListener("keydown", (event) => {
      if (currentAttempt >= maxAttempts) return;
      let key = event.key.toUpperCase();
      if (/^[A-ZÃ‘]$/.test(key) && currentLetter < 5) {
        attempts[currentAttempt][currentLetter] = { char: key, status: "" };
        currentLetter++;
      } else if (key === "BACKSPACE" && currentLetter > 0) {
        currentLetter--;
        attempts[currentAttempt][currentLetter] = { char: "", status: "" };
      } else if (key === "ENTER" && currentLetter === 5) {
        checkWord();
      }
      createGrid();
    });

    function updateStats(won) {
      let totalGames = parseInt(localStorage.getItem("totalGames") || 0) + 1;
      localStorage.setItem("totalGames", totalGames);

      let currentStreak = parseInt(localStorage.getItem("currentStreak") || 0);
      let bestStreak = parseInt(localStorage.getItem("bestStreak") || 0);

      if (won) {
        currentStreak++;
        if (currentStreak > bestStreak) bestStreak = currentStreak;
      } else {
        currentStreak = 0;
      }

      localStorage.setItem("currentStreak", currentStreak);
      localStorage.setItem("bestStreak", bestStreak);

      document.getElementById("totalGames").textContent = totalGames;
      document.getElementById("currentStreak").textContent = currentStreak;
      document.getElementById("bestStreak").textContent = bestStreak;
    }

    function checkWord() {
      const input = attempts[currentAttempt].map(cell => cell.char).join("");
      if (input.length !== 5) return;
      
      attempts[currentAttempt] = input.split('').map((char, i) => {
        if (char === word[i]) {
          usedLetters[char] = "correct";
          return { char, status: "correct" };
        }
        if (word.includes(char)) {
          usedLetters[char] = "present";
          return { char, status: "present" };
        }
        usedLetters[char] = "absent";
        return { char, status: "absent" };
      });

      currentAttempt++;
      currentLetter = 0;
      createGrid();
      createKeyboard();

      if (input === word) {
        updateStats(true);
        document.getElementById("definition").textContent = `\"${word}\" significa: ${definitions[word]}`;
        document.getElementById("popup").style.display = "block";
      } else if (currentAttempt >= maxAttempts) {
        updateStats(false);
        document.getElementById("message").textContent = `Perdiste. La palabra era ${word}.`;
      }
    }

    function closePopup() {
      document.getElementById("popup").style.display = "none";
    }

    function updateCountdown() {
      const now = new Date();
      const tomorrow = new Date();
      tomorrow.setDate(now.getDate() + 1);
      tomorrow.setHours(0, 0, 0, 0);
      const diff = tomorrow - now;
      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);
      document.getElementById("countdown").textContent = `Nueva palabra en ${hours}h ${minutes}m ${seconds}s`;
    }
    
    setInterval(updateCountdown, 1000);
    updateCountdown();

    createGrid();
    createKeyboard();
  </script>
</body>
</html>
